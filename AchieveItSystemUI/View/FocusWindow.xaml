<Window x:Class="AchieveItSystemUI.FocusWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:AchieveItSystemUI"
        Title="{Binding WindowTitle}" 
        Height="500" 
        Width="400"
        WindowStartupLocation="CenterScreen"
        Background="#1e1e1e"
        x:Name="FocusWindowView">

    <Window.Resources>
        <converters:FocusStateToTextConverter x:Key="FocusStateToTextConverter"/>
        <converters:UniversalBoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>

        <Style x:Key="FocusButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#2c3e50"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Padding" Value="25,12"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Margin" Value="10,5"/>
        </Style>
    </Window.Resources>


    <Grid>
        <!-- 正常模式布局 -->
        <Grid Visibility="{Binding Focus.IsFullScreen, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=inverse}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- 标题栏 -->
            <Border Grid.Row="0" Background="#2c3e50" Padding="15,10">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Button Grid.Column="0" 
                           Command="{Binding BackPortalCommand}" 
                           CommandParameter="{Binding ElementName=FocusWindowView}"
                           Background="Transparent" 
                           BorderThickness="0"
                           Padding="5">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock FontFamily="{StaticResource SymbolThemeFontFamily}" 
                                      Text="&#xE72B;"
                                      FontSize="16" 
                                      Foreground="White"
                                      VerticalAlignment="Center"/>
                            <TextBlock Text="返回" 
                                      FontSize="14" 
                                      Foreground="White"
                                      Margin="5,0,0,0"
                                      VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <TextBox Grid.Column="1" 
                            Text="{Binding WindowTitle, UpdateSourceTrigger=PropertyChanged}" 
                            FontSize="16"
                            Padding="10,5"
                            VerticalAlignment="Center"
                            BorderThickness="0"
                            Background="Transparent"
                            Foreground="White"
                            TextAlignment="Center"/>

                    <Button Grid.Column="2" 
                           Content="开始专注" 
                           Command="{Binding StartFocusCommand}"
                           CommandParameter="{Binding ElementName=FocusWindowView}"
                           Background="#27ae60"
                           Foreground="White"
                           FontSize="14"
                           FontWeight="Bold"
                           Padding="15,8"
                           BorderThickness="0"/>
                </Grid>
            </Border>

            <!-- 时间显示区域 -->
            <StackPanel Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center">
                <TextBlock Text="{Binding Focus.DisplayTime}" 
                          FontSize="48" 
                          FontWeight="Light"
                          Foreground="#ecf0f1"
                          HorizontalAlignment="Center"
                          Margin="0,0,0,20"/>

                <TextBlock Text="准备专注" 
                          FontSize="18" 
                          Foreground="#bdc3c7"
                          HorizontalAlignment="Center"/>

                <TextBlock Text="点击 开始专注 进入全屏模式" 
                          FontSize="12" 
                          Foreground="#7f8c8d"
                          HorizontalAlignment="Center"
                          Margin="0,20,0,0"/>
            </StackPanel>

            <!-- 控制按钮 -->
            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,30">
                <Button Content="{Binding Focus.IsRunning, Converter={StaticResource FocusStateToTextConverter}}" 
                       Command="{Binding PauseResumeCommand}"
                       Style="{StaticResource FocusButtonStyle}"
                       Background="#f39c12"/>

                <Button Content="退出" 
                       Command="{Binding ExitFocusCommand}"
                       CommandParameter="{Binding ElementName=FocusWindowView}"
                       Style="{StaticResource FocusButtonStyle}"
                       Background="#e74c3c"/>
            </StackPanel>
        </Grid>

        <!-- 全屏模式布局 -->
        <Grid Background="#1a1a1a" 
              Visibility="{Binding Focus.IsFullScreen, Converter={StaticResource BoolToVisibilityConverter}}">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- 全屏时间显示 -->
            <StackPanel Grid.Row="0" HorizontalAlignment="Center" VerticalAlignment="Center">
                <TextBlock Text="{Binding Focus.DisplayTime}" 
                          FontSize="96" 
                          FontWeight="Light"
                          Foreground="#2ecc71"
                          HorizontalAlignment="Center"
                          Margin="0,0,0,30"/>

                <TextBlock Text="专注时间" 
                          FontSize="24" 
                          Foreground="#95a5a6"
                          HorizontalAlignment="Center"/>
            </StackPanel>

            <!-- 全屏控制按钮 -->
            <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,80">
                <Button Content="{Binding Focus.IsRunning, Converter={StaticResource FocusStateToTextConverter}}" 
                       Command="{Binding PauseResumeCommand}"
                       Style="{StaticResource FocusButtonStyle}"
                       Background="#f39c12"
                       FontSize="18"
                       Padding="40,15"/>

                <Button Content="退出专注" 
                       Command="{Binding ExitFocusCommand}"
                       CommandParameter="{Binding ElementName=FocusWindowView}"
                       Style="{StaticResource FocusButtonStyle}"
                       Background="#e74c3c"
                       FontSize="18"
                       Padding="40,15"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>